# WCPOS 1.8.13

## What’s new

### ✅ Fixed the metadata-duplication root cause
WCPOS no longer clones product objects during the stock/coupon lifecycle. That clone path was re-saving product metadata and could duplicate rows repeatedly on active stores.

### ✅ Added a safer repair migration for affected stores
This release includes a one-time cleanup that removes only **exact duplicate** postmeta rows (`post_id`, `meta_key`, `meta_value`) for POS-touched products and variations.

### ✅ Stronger regression coverage
We added tests for coupon recalculation, variation discount behavior, and stock-reduction lifecycle so this class of issue stays fixed.

### ✅ Less noisy diagnostics
High-volume “top meta keys” log context is now opt-in, so normal logs stay useful while still supporting deep diagnostics when needed.

## Why this release matters
Stores affected by duplicated metadata can see very large API payloads, slower sync, and memory pressure. WCPOS 1.8.13 both fixes the cause and safely repairs existing damage.

## Upgrade notes
- Migration runs automatically once during upgrade.
- Check WooCommerce logs with source `woocommerce-pos` for migration summary.
- If your store has a very large catalog, run the upgrade during a lower-traffic window.

## References
- Issue: #536
- PR: #537
